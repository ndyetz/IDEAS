"0","#Reliability"
"0","rm(list=ls()) "
"0","my_reliability <- function (items, itemal = TRUE, NA.Delete = TRUE) "
"0","{"
"0","    if (!all(apply(items, c(1, 2), is.numeric))) {"
"0","        items <- apply(items, c(1, 2), as.numeric)"
"0","        warning(""Data is not numeric. Data has been coerced to be numeric."")"
"0","    }"
"0","        warning(""Missing values or NA values are converted to zeros."")"
"0","    }"
"0","    items <- na.omit(items)"
"0","    s <- apply(items, 2, var)"
"0","    X <- rowSums(items)"
"0","    alpha <- (N/(N - 1)) * (1 - sum(s)/var(X))"
"0","    if (itemal) {"
"0","        alphad <- array(dim = N)"
"0","        pbis <- array(dim = N)"
"0","        for (i in 1:N) {"
"0","            Xd <- rowSums(items[, -i])"
"0","            Mean <- sapply(items, mean)"
"0","            SD <- sapply(items, sd)"
"0","            Min <- sapply(items, min)"
"0","            Max <- sapply(items, max)"
"0","            Nobs <- sapply(items, length)"
"0","            alphad[i] <- ((N - 1)/(N - 2)) * (1 - sum(s[-i])/var(Xd))"
"0","            pbis[i] <- cor(items[, i], Xd)"
"0","            out <- list(nItem = N, nPerson = nrow(items), alpha = alpha, "
"0","                scaleMean = mean(X), scaleSD = sd(X), Alpha.If.Deleted = alphad, "
"0","                R.With.Total = pbis, Mean = Mean, SD = SD, Min = Min, Max = Max, Nobs=Nobs)"
"0","        }"
"0","    else out <- list(nItem = N, nPerson = nrow(items), alpha = alpha, "
"0","        scaleMean = mean(X), scaleSD = sd(X))"
"0","    class(out) <- ""my_reliability"""
"0","    out"
"0","toofew <- function (items, itemal = FALSE, NA.Delete = TRUE) "
"0","{"
"0","    if (!all(apply(items, c(1, 2), is.numeric))) {"
"0","        items <- apply(items, c(1, 2), as.numeric)"
"0","        warning(""Data is not numeric. Data has been coerced to be numeric."")"
"0","    }"
"0","    if (NA.Delete == FALSE) {"
"0","        items[is.na(items)] <- 0"
"0","        warning(""Missing values or NA values are converted to zeros."")"
"0","    }"
"0","    items <- na.omit(items)"
"0","    s <- apply(items, 2, var)"
"0","    N <- ncol(items)"
"0","    X <- rowSums(items)"
"0","    if (itemal) {"
"0","        for (i in 1:N) {"
"0","            Mean <- sapply(items, mean)"
"0","            SD <- sapply(items, sd)"
"0","            Min <- sapply(items, min)"
"0","            Max <- sapply(items, max)"
"0","            Nobs <- sapply(items, length)"
"0","            out <- list(nItem = N, "
"0","                scaleMean = mean(X), scaleSD = sd(X), "
"0","                Mean = Mean, SD = SD, Min = Min, Max = Max, Nobs=Nobs)"
"0","        }"
"0","    }"
"0","    else out <- list(nItem = N, nPerson = nrow(items),  "
"0","        scaleMean = mean(X), scaleSD = sd(X), Mean = Mean, SD = SD, Min = Min, Max = Max, Nobs=Nobs)"
"0","    class(out) <- ""toofew"""
"0","    out"
"0","}"
